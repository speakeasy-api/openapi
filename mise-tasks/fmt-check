#!/usr/bin/env bash
set -euo pipefail

echo "üîç Checking Go code formatting..."

# Check if any files need formatting
# Only capture stdout (actual formatting output), let stderr (dependency downloads) go to terminal
UNFORMATTED=$(go fmt ./... 2>/dev/null || true)

if [ -n "$UNFORMATTED" ]; then
    echo "‚ùå The following files are not properly formatted:"
    echo "$UNFORMATTED"
    echo ""
    echo "Please run 'mise run fmt' to fix formatting issues."
    exit 1
fi

echo "‚úÖ All Go files are properly formatted!"