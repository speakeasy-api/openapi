#!/usr/bin/env bash
set -euo pipefail

echo "üîç Running linting checks..."

GOLANGCI_VERSION=$(golangci-lint --version | grep -oP 'golangci-lint has version \K[0-9.]+' || echo "unknown")
echo "üßπ Running golangci-lint v${GOLANGCI_VERSION} (includes go vet)..."
golangci-lint run

echo "üõ°Ô∏è  Running nilaway..."
if command -v nilaway >/dev/null 2>&1; then
    nilaway -test=false ./...
else
    echo "‚ö†Ô∏è  nilaway not found, installing..."
    go install go.uber.org/nilaway/cmd/nilaway@8ad05f0
    nilaway -test=false ./...
fi

echo "‚úÖ All linting checks passed!"